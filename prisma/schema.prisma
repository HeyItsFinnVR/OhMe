// Define client for interacting with database with js
generator client {
  provider = "prisma-client-js"
}

// Define database provider and url.
// This project uses a file based database,
// apposed to one hosted by a provider
datasource db {
  provider = "sqlite"
  url      = "file:./database.sqlite"
}



// Define User model
model User {
  id                String       @id @unique @default(uuid())

  // User information
  username          String       @unique   
  web3Wallet        String?     

  // Relations
  emailAddress      String       @unique
  email             Email        @relation(references: [address], fields: [emailAddress], onDelete: Restrict, onUpdate: Cascade)

  passwordId        String       @unique
  password          Password     @relation(references: [id], fields: [passwordId]) 

  sessions          Session[]    
}

model Email {
  id            String      @id @unique @default(uuid())

  // Email information
  address       String      @unique
  verified      Boolean     @default(false)
  verifyLink    String      @unique @default(uuid())
  linkSentAt    DateTime    @default(now())

  // Used to reference which user is linked to this email
  user          User?     
}

model Password {
  id            String       @id @unique @default(uuid())

  // Password information
  hash          String
  resetLink     String?      @unique 
  linkSentAt    DateTime?

  // Used to reference which user is linked to this password
  user              User?
}

model Session {
  id           String      @id @unique @default(uuid())

  // Indicates when a session expires 
  expiresAt    DateTime

  // Used to reference which user is linked to this session
  userId       String
  user         User        @relation(references: [id], fields: [userId], onDelete: Cascade)
}